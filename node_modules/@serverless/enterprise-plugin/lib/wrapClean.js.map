{"version":3,"sources":["../../lib/wrapClean.js"],"names":["fs","require","path","module","exports","ctx","pathExistsSync","state","pathAssets","removeSync","Object","keys","functions","func","fn","file","runtime","includes","entryNew","filePath","join","sls","config","servicePath"],"mappings":"AAAA;AAEA;;;;;;;;;AAKA,MAAMA,EAAE,GAAGC,OAAO,CAAC,UAAD,CAAlB;;AACA,MAAMC,IAAI,GAAGD,OAAO,CAAC,MAAD,CAApB;;AAEAE,MAAM,CAACC,OAAP;AAAA,+BAAiB,WAAOC,GAAP,EAAe;AAC9B;AACA,QAAIL,EAAE,CAACM,cAAH,CAAkBD,GAAG,CAACE,KAAJ,CAAUC,UAA5B,CAAJ,EAA6C;AAC3CR,MAAAA,EAAE,CAACS,UAAH,CAAcJ,GAAG,CAACE,KAAJ,CAAUC,UAAxB;AACD;;AAED,oCAAmBE,MAAM,CAACC,IAAP,CAAYN,GAAG,CAACE,KAAJ,CAAUK,SAAtB,CAAnB,kCAAqD;AAAhD,YAAMC,IAAI,mBAAV;AACH,YAAMC,EAAE,GAAGT,GAAG,CAACE,KAAJ,CAAUK,SAAV,CAAoBC,IAApB,CAAX;AAEA,UAAIE,IAAJ;;AACA,UAAID,EAAE,CAACE,OAAH,CAAWC,QAAX,CAAoB,MAApB,CAAJ,EAAiC;AAC/BF,QAAAA,IAAI,GAAI,GAAED,EAAE,CAACI,QAAS,KAAtB;AACD,OAFD,MAEO,IAAIJ,EAAE,CAACE,OAAH,CAAWC,QAAX,CAAoB,QAApB,CAAJ,EAAmC;AACxCF,QAAAA,IAAI,GAAI,GAAED,EAAE,CAACI,QAAS,KAAtB;AACD;;AAED,YAAMC,QAAQ,GAAGjB,IAAI,CAACkB,IAAL,CAAUf,GAAG,CAACgB,GAAJ,CAAQC,MAAR,CAAeC,WAAzB,EAAsCR,IAAtC,CAAjB,CAVmD,CAYnD;;AACA,UAAIf,EAAE,CAACM,cAAH,CAAkBa,QAAlB,CAAJ,EAAiC;AAC/BnB,QAAAA,EAAE,CAACS,UAAH,CAAcU,QAAd;AACD;AACF;AACF,GAvBD;;AAAA;AAAA;AAAA;AAAA","sourcesContent":["'use strict';\n\n/*\n * Wrap Clean\n * - Cleans up files create during wrapping\n */\n\nconst fs = require('fs-extra');\nconst path = require('path');\n\nmodule.exports = async (ctx) => {\n  // Clear assets (serverless-sdk)\n  if (fs.pathExistsSync(ctx.state.pathAssets)) {\n    fs.removeSync(ctx.state.pathAssets);\n  }\n\n  for (const func of Object.keys(ctx.state.functions)) {\n    const fn = ctx.state.functions[func];\n\n    let file;\n    if (fn.runtime.includes('node')) {\n      file = `${fn.entryNew}.js`;\n    } else if (fn.runtime.includes('python')) {\n      file = `${fn.entryNew}.py`;\n    }\n\n    const filePath = path.join(ctx.sls.config.servicePath, file);\n\n    // Clear wrapper file for this function\n    if (fs.pathExistsSync(filePath)) {\n      fs.removeSync(filePath);\n    }\n  }\n};\n"],"file":"wrapClean.js"}