{"version":3,"sources":["../../../lib/interactiveCli/register.js"],"names":["chalk","require","createApp","getLoggedInUser","getMetadata","login","sdkRegister","register","writeConfigFile","sdkVersion","version","enableConfirm","writeOrgAndApp","isValidEmail","RegExp","prototype","test","bind","args","result","orgName","tenantName","registerQuestion","inquirer","prompt","message","type","name","choices","accessMode","emailInput","validate","input","trim","toLowerCase","dashboardEmail","passwordInput","length","dashboardPassword","sdkSignUp","email","password","userName","error","errorData","JSON","parse","parseError","errorMessage","includes","trailingNumberMatches","match","Number","sdkMessage","generateUserName","slice","indexOf","replace","repeat","Math","max","keepValidOrgNameChars","generateOrgName","signUp","process","stdout","write","red","validadateRegistrationResponseValue","value","Error","steps","registerOrLogin","serverless","interactiveCli","ownerUserName","ownerAccessKey","ownerAuth0Id","userId","users","enterprise","versionSDK","timeLastLogin","round","Date","now","dashboard","accessKeys","username","green","tenant","app","service","token","appName","module","exports","check","config","servicePath","provider","supportedRegions","supportedRuntimes","runtime","getProvider","getRegion","run","processedInput","options"],"mappings":"AAAA;;;;;;AAEA,MAAMA,KAAK,GAAGC,OAAO,CAAC,OAAD,CAArB;;iBAQIA,OAAO,CAAC,0BAAD,C;MANTC,S,YAAAA,S;MACAC,e,YAAAA,e;MACAC,W,YAAAA,W;MACAC,K,YAAAA,K;MACUC,W,YAAVC,Q;MACAC,e,YAAAA,e;;AAEF,MAAMC,UAAU,GAAGR,OAAO,CAAC,kCAAD,CAAP,CAA4CS,OAA/D;;AACA,MAAMC,aAAa,GAAGV,OAAO,CAAC,iBAAD,CAA7B;;AACA,MAAMW,cAAc,GAAGX,OAAO,CAAC,kBAAD,CAA9B;;AAEA,MAAMY,YAAY,GAAGC,MAAM,CAACC,SAAP,CAAiBC,IAAjB,CAAsBC,IAAtB,CACnB,IAAIH,MAAJ,CACE,6EACE,sFADF,GAEE,wEAFF,GAGE,wEAHF,GAIE,wEAJF,GAKE,sEALF,GAME,kEAPJ,CADmB,CAArB;;AAYA,MAAMP,QAAQ;AAAA,+BAAG,WAAO,GAAGW,IAAV,EAAmB;AAClC,UAAMC,MAAM,SAASb,WAAW,CAAC,GAAGY,IAAJ,CAAhC;AACAC,IAAAA,MAAM,CAACC,OAAP,GAAiBD,MAAM,CAACE,UAAxB;AACA,WAAOF,MAAM,CAACE,UAAd;AACA,WAAOF,MAAP;AACD,GALa;;AAAA,kBAARZ,QAAQ;AAAA;AAAA;AAAA,GAAd;;AAOA,MAAMe,gBAAgB;AAAA,gCAAG,WAAOC,QAAP;AAAA,WACvB,OACQA,QAAQ,CAACC,MAAT,CAAgB;AACpBC,MAAAA,OAAO,EAAE,mCADW;AAEpBC,MAAAA,IAAI,EAAE,MAFc;AAGpBC,MAAAA,IAAI,EAAE,YAHc;AAIpBC,MAAAA,OAAO,EAAE,CAAC,UAAD,EAAa,OAAb;AAJW,KAAhB,CADR,EAOEC,UARqB;AAAA,GAAH;;AAAA,kBAAhBP,gBAAgB;AAAA;AAAA;AAAA,GAAtB;;AAUA,MAAMQ,UAAU;AAAA,gCAAG,WAAOP,QAAP;AAAA,WACjB,OACQA,QAAQ,CAACC,MAAT,CAAgB;AACpBC,MAAAA,OAAO,EAAE,QADW;AAEpBC,MAAAA,IAAI,EAAE,OAFc;AAGpBC,MAAAA,IAAI,EAAE,gBAHc;AAIpBI,MAAAA,QAAQ,EAAGC,KAAD,IAAW;AACnBA,QAAAA,KAAK,GAAGA,KAAK,CAACC,IAAN,GAAaC,WAAb,EAAR;AACA,YAAIrB,YAAY,CAACmB,KAAD,CAAhB,EAAyB,OAAO,IAAP;AACzB,eAAO,qCAAP;AACD;AARmB,KAAhB,CADR,EAWEG,cAXF,CAYGF,IAZH,GAaGC,WAbH,EADiB;AAAA,GAAH;;AAAA,kBAAVJ,UAAU;AAAA;AAAA;AAAA,GAAhB;;AAgBA,MAAMM,aAAa;AAAA,gCAAG,WAAOb,QAAP;AAAA,WACpB,OACQA,QAAQ,CAACC,MAAT,CAAgB;AACpBC,MAAAA,OAAO,EAAE,WADW;AAEpBC,MAAAA,IAAI,EAAE,UAFc;AAGpBC,MAAAA,IAAI,EAAE,mBAHc;AAIpBI,MAAAA,QAAQ,EAAGC,KAAD,IAAW;AACnB,YAAIA,KAAK,CAACC,IAAN,GAAaI,MAAb,IAAuB,CAA3B,EAA8B,OAAO,IAAP;AAC9B,eAAO,8CAAP;AACD;AAPmB,KAAhB,CADR,EAUEC,iBAVF,CAUoBL,IAVpB,EADoB;AAAA,GAAH;;AAAA,kBAAbG,aAAa;AAAA;AAAA;AAAA,GAAnB;;AAaA,MAAMG,SAAS;AAAA,gCAAG,WAAOC,KAAP,EAAcC,QAAd,EAAwBC,QAAxB,EAAkCtB,OAAlC,EAA8C;AAC9D,QAAI;AACF,mBAAab,QAAQ,CAACiC,KAAD,EAAQC,QAAR,EAAkBC,QAAlB,EAA4BtB,OAA5B,EAAqCA,OAArC,CAArB;AACD,KAFD,CAEE,OAAOuB,KAAP,EAAc;AACd,YAAMC,SAAS,GAAG,CAAC,MAAM;AACvB,YAAI;AACF,iBAAOC,IAAI,CAACC,KAAL,CAAWH,KAAK,CAAClB,OAAjB,CAAP;AACD,SAFD,CAEE,OAAOsB,UAAP,EAAmB;AACnB,gBAAMJ,KAAN;AACD;AACF,OANiB,GAAlB;;AAOA,UAAI,CAACC,SAAD,IAAc,CAACA,SAAS,CAACI,YAA7B,EAA2C,MAAML,KAAN;;AAC3C,UAAIC,SAAS,CAACI,YAAV,CAAuBC,QAAvB,CAAgC,8BAAhC,CAAJ,EAAqE;AACnE,cAAMC,qBAAqB,GAAGR,QAAQ,CAACS,KAAT,CAAe,aAAf,CAA9B;;AACA,YAAID,qBAAJ,EAA2B;AACzBR,UAAAA,QAAQ,GAAGQ,qBAAqB,CAAC,CAAD,CAArB,IAA4BE,MAAM,CAACF,qBAAqB,CAAC,CAAD,CAAtB,CAAN,GAAmC,CAA/D,CAAX;AACD,SAFD,MAEO;AACLR,UAAAA,QAAQ,IAAI,GAAZ;AACD;;AACD,eAAOH,SAAS,CAACC,KAAD,EAAQC,QAAR,EAAkBC,QAAlB,EAA4BtB,OAA5B,CAAhB;AACD;;AACD,UAAIwB,SAAS,CAACI,YAAV,CAAuBC,QAAvB,CAAgC,sCAAhC,CAAJ,EAA6E;AAC3E,cAAMC,qBAAqB,GAAG9B,OAAO,CAAC+B,KAAR,CAAc,aAAd,CAA9B;;AACA,YAAID,qBAAJ,EAA2B;AACzB9B,UAAAA,OAAO,GAAG8B,qBAAqB,CAAC,CAAD,CAArB,IAA4BE,MAAM,CAACF,qBAAqB,CAAC,CAAD,CAAtB,CAAN,GAAmC,CAA/D,CAAV;AACD,SAFD,MAEO;AACL9B,UAAAA,OAAO,IAAI,GAAX;AACD;;AACD,eAAOmB,SAAS,CAACC,KAAD,EAAQC,QAAR,EAAkBC,QAAlB,EAA4BtB,OAA5B,CAAhB;AACD;;AACD,UAAIwB,SAAS,CAACI,YAAV,CAAuBC,QAAvB,CAAgC,sCAAhC,CAAJ,EAA6E;AAC3E7B,QAAAA,OAAO,IAAI,GAAX;AACA,eAAOmB,SAAS,CAACC,KAAD,EAAQC,QAAR,EAAkBC,QAAlB,EAA4BtB,OAA5B,CAAhB;AACD;;AACDuB,MAAAA,KAAK,CAACU,UAAN,GAAmBT,SAAS,CAACI,YAA7B;AACA,YAAML,KAAN;AACD;AACF,GArCc;;AAAA,kBAATJ,SAAS;AAAA;AAAA;AAAA,GAAf;;AAuCA,MAAMe,gBAAgB,GAAId,KAAD,IAAW;AAClC,MAAIE,QAAQ,GAAGF,KAAK,CAACe,KAAN,CAAY,CAAZ,EAAef,KAAK,CAACgB,OAAN,CAAc,GAAd,CAAf,EAAmCC,OAAnC,CAA2C,aAA3C,EAA0D,EAA1D,CAAf;;AACA,MAAIf,QAAQ,CAACL,MAAT,KAAoB,CAAxB,EAA2B;AACzBK,IAAAA,QAAQ,GAAGF,KAAK,CAACe,KAAN,CAAY,IAAIf,KAAK,CAACgB,OAAN,CAAc,GAAd,CAAhB,EAAoCC,OAApC,CAA4C,aAA5C,EAA2D,EAA3D,CAAX;AACD;;AACDf,EAAAA,QAAQ,IAAI,IAAIgB,MAAJ,CAAWC,IAAI,CAACC,GAAL,CAAS,IAAIlB,QAAQ,CAACL,MAAtB,EAA8B,CAA9B,CAAX,CAAZ;AACA,SAAOK,QAAP;AACD,CAPD;;AASA,MAAMmB,qBAAqB,GAAIlC,IAAD,IAAUA,IAAI,CAAC8B,OAAL,CAAa,eAAb,EAA8B,EAA9B,CAAxC;;AACA,MAAMK,eAAe,GAAItB,KAAD,IAAW;AACjC,QAAME,QAAQ,GAAGY,gBAAgB,CAACd,KAAD,CAAjC;AACA,SAAOqB,qBAAqB,CAACnB,QAAD,CAA5B;AACD,CAHD;;AAKA,MAAMqB,MAAM;AAAA,gCAAG,WAAOxC,QAAP,EAAiBiB,KAAK,GAAG,IAAzB,EAAkC;AAC/C,QAAI,CAACA,KAAL,EAAYA,KAAK,SAASV,UAAU,CAACP,QAAD,CAAxB;AACZ,UAAMkB,QAAQ,SAASL,aAAa,CAACb,QAAD,CAApC;AACA,UAAMmB,QAAQ,GAAGY,gBAAgB,CAACd,KAAD,CAAjC;AACA,UAAMpB,OAAO,GAAG0C,eAAe,CAACtB,KAAD,CAA/B;;AAEA,QAAI;AACF,mBAAaD,SAAS,CAACC,KAAD,EAAQC,QAAR,EAAkBC,QAAlB,EAA4BtB,OAA5B,CAAtB;AACD,KAFD,CAEE,OAAOuB,KAAP,EAAc;AACd,UAAIA,KAAK,CAACU,UAAV,EAAsB;AACpB,YAAIV,KAAK,CAACU,UAAN,CAAiBJ,QAAjB,CAA0B,qBAA1B,CAAJ,EAAsD;AACpD;AACAe,UAAAA,OAAO,CAACC,MAAR,CAAeC,KAAf,CACElE,KAAK,CAACmE,GAAN,CACE,kGADF,CADF;AAKA,iBAAOJ,MAAM,CAACxC,QAAD,CAAb;AACD;;AACD,YAAIoB,KAAK,CAACU,UAAN,CAAiBJ,QAAjB,CAA0B,uBAA1B,CAAJ,EAAwD;AACtDe,UAAAA,OAAO,CAACC,MAAR,CAAeC,KAAf,CAAqBlE,KAAK,CAACmE,GAAN,CAAU,kDAAV,CAArB;AACA,iBAAOJ,MAAM,CAACxC,QAAD,EAAWiB,KAAX,CAAb;AACD;AACF;;AACD,YAAMG,KAAN;AACD;AACF,GA1BW;;AAAA,kBAANoB,MAAM;AAAA;AAAA;AAAA,GAAZ;;AA4BA,MAAMK,mCAAmC,GAAG,CAACzC,IAAD,EAAO0C,KAAP,KAAiB;AAC3D,MAAI,CAACA,KAAL,EAAY,MAAM,IAAIC,KAAJ,CAAW,WAAU3C,IAAK,uBAA1B,CAAN;AACb,CAFD;;AAIA,MAAM4C,KAAK,GAAG;AACZC,EAAAA,eAAe;AAAA,6CAAE,WAAOC,UAAP,EAAsB;AAAA,YAC7BlD,QAD6B,GAChBkD,UAAU,CAACC,cADK,CAC7BnD,QAD6B;AAErC,YAAMiD,eAAe,SAASlD,gBAAgB,CAACC,QAAD,CAA9C;;AACA,UAAIiD,eAAe,KAAK,OAAxB,EAAiC;AAC/B,cAAMnE,KAAK,EAAX;AACA;AACD;;AANoC,kCAOkC0D,MAAM,CAACxC,QAAD,CAPxC;AAAA,YAO7BoD,aAP6B,iBAO7BA,aAP6B;AAAA,YAOdvD,OAPc,iBAOdA,OAPc;AAAA,YAOLwD,cAPK,iBAOLA,cAPK;AAAA,YAOWC,YAPX,iBAOWA,YAPX;;AAQrCT,MAAAA,mCAAmC,CAAC,eAAD,EAAkBO,aAAlB,CAAnC;AACAP,MAAAA,mCAAmC,CAAC,YAAD,EAAehD,OAAf,CAAnC;AACAgD,MAAAA,mCAAmC,CAAC,gBAAD,EAAmBQ,cAAnB,CAAnC;AACAR,MAAAA,mCAAmC,CAAC,cAAD,EAAiBS,YAAjB,CAAnC;AACArE,MAAAA,eAAe,CAAC;AACdsE,QAAAA,MAAM,EAAED,YADM;AAEdE,QAAAA,KAAK,EAAE;AACL,WAACF,YAAD,GAAgB;AACdC,YAAAA,MAAM,EAAED,YADM;AAEdnC,YAAAA,QAAQ,EAAEiC,aAFI;AAGdK,YAAAA,UAAU,EAAE;AACVC,cAAAA,UAAU,EAAExE,UADF;AAEVyE,cAAAA,aAAa,EAAEvB,IAAI,CAACwB,KAAL,CAAWC,IAAI,CAACC,GAAL,KAAa,IAAxB;AAFL,aAHE;AAOdC,YAAAA,SAAS,EAAE;AACTC,cAAAA,UAAU,EAAE;AACV,iBAACnE,OAAD,GAAWwD;AADD,eADH;AAITY,cAAAA,QAAQ,EAAEb;AAJD;AAPG;AADX;AAFO,OAAD,CAAf;AAoBAX,MAAAA,OAAO,CAACC,MAAR,CAAeC,KAAf,CAAsB,KAAIlE,KAAK,CAACyF,KAAN,CAAY,0CAAZ,CAAwD,IAAlF;;AAhCqC,qCAkCXvF,SAAS,CAAC;AAClCwF,QAAAA,MAAM,EAAEtE,OAD0B;AAElCuE,QAAAA,GAAG,EAAG,GAAElB,UAAU,CAACmB,OAAX,CAAmBA,OAAQ,MAFD;AAGlCC,QAAAA,KAAK,EAAEjB;AAH2B,OAAD,CAlCE;AAAA,YAkC7BkB,OAlC6B,oBAkC7BA,OAlC6B;;AAwCrC,YAAMlF,cAAc,CAAC6D,UAAD,EAAarD,OAAb,EAAsB0E,OAAtB,CAApB;AACD,KAzCc;;AAAA;AAAA;AAAA;;AAAA;AAAA;AADH,CAAd;AA6CAC,MAAM,CAACC,OAAP,GAAiB;AACTC,EAAAA,KAAN,CAAYxB,UAAZ,EAAwB;AAAA;AACtB,UAAI,CAACA,UAAU,CAACyB,MAAX,CAAkBC,WAAvB,EAAoC,OAAO,KAAP;;AACpC,UAAI1B,UAAU,CAACmB,OAAX,CAAmBQ,QAAnB,CAA4BzE,IAA5B,KAAqC,KAAzC,EAAgD;AAC9C,eAAO,KAAP;AACD;;AAJqB,uCAKgCvB,WAAW,EAL3C;AAAA,YAKdiG,gBALc,sBAKdA,gBALc;AAAA,YAKIC,iBALJ,sBAKIA,iBALJ;;AAMtB,UAAI,CAACA,iBAAiB,CAACrD,QAAlB,CAA2BwB,UAAU,CAACmB,OAAX,CAAmBQ,QAAnB,CAA4BG,OAA5B,IAAuC,YAAlE,CAAL,EAAsF;AACpF,eAAO,KAAP;AACD;;AACD,UAAI,CAACF,gBAAgB,CAACpD,QAAjB,CAA0BwB,UAAU,CAAC+B,WAAX,CAAuB,KAAvB,EAA8BC,SAA9B,EAA1B,CAAL,EAA2E;AACzE,eAAO,KAAP;AACD;;AACD,aAAO,CAACtG,eAAe,EAAvB;AAZsB;AAavB,GAdc;;AAeTuG,EAAAA,GAAN,CAAUjC,UAAV,EAAsB;AAAA;AAAA,YACZlD,QADY,GACCkD,UAAU,CAACC,cADZ,CACZnD,QADY;;AAEpB,UAAI,QAAQZ,aAAa,CAACY,QAAD,EAAWkD,UAAU,CAACkC,cAAX,CAA0BC,OAArC,CAArB,CAAJ,EAAyE;AACvE,eAAO,IAAP;AACD;;AACD5C,MAAAA,OAAO,CAACC,MAAR,CAAeC,KAAf,CAAqB,oEAArB;AACA,aAAOK,KAAK,CAACC,eAAN,CAAsBC,UAAtB,CAAP;AANoB;AAOrB,GAtBc;;AAuBfF,EAAAA;AAvBe,CAAjB","sourcesContent":["'use strict';\n\nconst chalk = require('chalk');\nconst {\n  createApp,\n  getLoggedInUser,\n  getMetadata,\n  login,\n  register: sdkRegister,\n  writeConfigFile,\n} = require('@serverless/platform-sdk');\nconst sdkVersion = require('@serverless/platform-sdk/package').version;\nconst enableConfirm = require('./enableConfirm');\nconst writeOrgAndApp = require('./writeOrgAndApp');\n\nconst isValidEmail = RegExp.prototype.test.bind(\n  new RegExp(\n    \"^(?:[a-z0-9!#$%&'*+/=?^_`{|}~\\u007f-\\uffff-]+(?:\\\\.[a-z0-9!#$%&'*+/=?^_`\" +\n      '{|}~\\\\u007f-\\\\uffff-]+)*|\"(?:[\\\\x01-\\\\x08\\\\x0b\\\\x0c\\\\x0e-\\\\x1f\\\\x21\\\\x23-\\\\x5b\\\\x5d-' +\n      '\\\\x7f]|\\\\\\\\[\\\\x01-\\\\x09\\\\x0b\\\\x0c\\\\x0e-\\\\x7f])*\")@(?:(?:[a-z0-9](?:[a-' +\n      'z0-9-]*[a-z0-9])?\\\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\\\\[(?:(?:25[0-5]' +\n      '|2[0-4][0-9]|[01]?[0-9][0-9]?)\\\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9]' +\n      '[0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\\\\x01-\\\\x08\\\\x0b\\\\x0c\\\\x0e-\\\\x1f\\\\x21-' +\n      '\\\\x5a\\\\x53-\\\\x7f]|\\\\\\\\[\\\\x01-\\\\x09\\\\x0b\\\\x0c\\\\x0e-\\\\x7f])+)\\\\])$'\n  )\n);\n\nconst register = async (...args) => {\n  const result = await sdkRegister(...args);\n  result.orgName = result.tenantName;\n  delete result.tenantName;\n  return result;\n};\n\nconst registerQuestion = async (inquirer) =>\n  (\n    await inquirer.prompt({\n      message: 'Do you want to login or register?',\n      type: 'list',\n      name: 'accessMode',\n      choices: ['register', 'login'],\n    })\n  ).accessMode;\n\nconst emailInput = async (inquirer) =>\n  (\n    await inquirer.prompt({\n      message: 'email:',\n      type: 'input',\n      name: 'dashboardEmail',\n      validate: (input) => {\n        input = input.trim().toLowerCase();\n        if (isValidEmail(input)) return true;\n        return 'Provided email address is not valid';\n      },\n    })\n  ).dashboardEmail\n    .trim()\n    .toLowerCase();\n\nconst passwordInput = async (inquirer) =>\n  (\n    await inquirer.prompt({\n      message: 'password:',\n      type: 'password',\n      name: 'dashboardPassword',\n      validate: (input) => {\n        if (input.trim().length >= 7) return true;\n        return 'Password needs to have at least 7 characters';\n      },\n    })\n  ).dashboardPassword.trim();\n\nconst sdkSignUp = async (email, password, userName, orgName) => {\n  try {\n    return await register(email, password, userName, orgName, orgName);\n  } catch (error) {\n    const errorData = (() => {\n      try {\n        return JSON.parse(error.message);\n      } catch (parseError) {\n        throw error;\n      }\n    })();\n    if (!errorData || !errorData.errorMessage) throw error;\n    if (errorData.errorMessage.includes('this username already exists')) {\n      const trailingNumberMatches = userName.match(/^(.*)(\\d+)$/);\n      if (trailingNumberMatches) {\n        userName = trailingNumberMatches[1] + (Number(trailingNumberMatches[2]) + 1);\n      } else {\n        userName += '2';\n      }\n      return sdkSignUp(email, password, userName, orgName);\n    }\n    if (errorData.errorMessage.includes('tenant with this name already exists')) {\n      const trailingNumberMatches = orgName.match(/^(.*)(\\d+)$/);\n      if (trailingNumberMatches) {\n        orgName = trailingNumberMatches[1] + (Number(trailingNumberMatches[2]) + 1);\n      } else {\n        orgName += '2';\n      }\n      return sdkSignUp(email, password, userName, orgName);\n    }\n    if (errorData.errorMessage.includes('\"tenantName\" length must be at least')) {\n      orgName += 'x';\n      return sdkSignUp(email, password, userName, orgName);\n    }\n    error.sdkMessage = errorData.errorMessage;\n    throw error;\n  }\n};\n\nconst generateUserName = (email) => {\n  let userName = email.slice(0, email.indexOf('@')).replace(/[^a-z0-9]+/g, '');\n  if (userName.length === 0) {\n    userName = email.slice(1 + email.indexOf('@')).replace(/[^a-z0-9]+/g, '');\n  }\n  userName += 'x'.repeat(Math.max(5 - userName.length, 0));\n  return userName;\n};\n\nconst keepValidOrgNameChars = (name) => name.replace(/[^a-zA-Z0-9]/g, '');\nconst generateOrgName = (email) => {\n  const userName = generateUserName(email);\n  return keepValidOrgNameChars(userName);\n};\n\nconst signUp = async (inquirer, email = null) => {\n  if (!email) email = await emailInput(inquirer);\n  const password = await passwordInput(inquirer);\n  const userName = generateUserName(email);\n  const orgName = generateOrgName(email);\n\n  try {\n    return await sdkSignUp(email, password, userName, orgName);\n  } catch (error) {\n    if (error.sdkMessage) {\n      if (error.sdkMessage.includes('user already exists')) {\n        // There's already account with given email registered\n        process.stdout.write(\n          chalk.red(\n            \"There's already registered account for given email address. Please try different email address\\n\"\n          )\n        );\n        return signUp(inquirer);\n      }\n      if (error.sdkMessage.includes('PasswordStrengthError')) {\n        process.stdout.write(chalk.red('Password is too weak. Please try different one\\n'));\n        return signUp(inquirer, email);\n      }\n    }\n    throw error;\n  }\n};\n\nconst validadateRegistrationResponseValue = (name, value) => {\n  if (!value) throw new Error(`Missing ${name} in register response`);\n};\n\nconst steps = {\n  registerOrLogin: async (serverless) => {\n    const { inquirer } = serverless.interactiveCli;\n    const registerOrLogin = await registerQuestion(inquirer);\n    if (registerOrLogin === 'login') {\n      await login();\n      return;\n    }\n    const { ownerUserName, orgName, ownerAccessKey, ownerAuth0Id } = await signUp(inquirer);\n    validadateRegistrationResponseValue('ownerUserName', ownerUserName);\n    validadateRegistrationResponseValue('tenantName', orgName);\n    validadateRegistrationResponseValue('ownerAccessKey', ownerAccessKey);\n    validadateRegistrationResponseValue('ownerAuth0Id', ownerAuth0Id);\n    writeConfigFile({\n      userId: ownerAuth0Id,\n      users: {\n        [ownerAuth0Id]: {\n          userId: ownerAuth0Id,\n          userName: ownerUserName,\n          enterprise: {\n            versionSDK: sdkVersion,\n            timeLastLogin: Math.round(Date.now() / 1000),\n          },\n          dashboard: {\n            accessKeys: {\n              [orgName]: ownerAccessKey,\n            },\n            username: ownerUserName,\n          },\n        },\n      },\n    });\n\n    process.stdout.write(`\\n${chalk.green('Successfully registered your new account')}\\n`);\n\n    const { appName } = await createApp({\n      tenant: orgName,\n      app: `${serverless.service.service}-app`,\n      token: ownerAccessKey,\n    });\n\n    await writeOrgAndApp(serverless, orgName, appName);\n  },\n};\n\nmodule.exports = {\n  async check(serverless) {\n    if (!serverless.config.servicePath) return false;\n    if (serverless.service.provider.name !== 'aws') {\n      return false;\n    }\n    const { supportedRegions, supportedRuntimes } = await getMetadata();\n    if (!supportedRuntimes.includes(serverless.service.provider.runtime || 'nodejs10.x')) {\n      return false;\n    }\n    if (!supportedRegions.includes(serverless.getProvider('aws').getRegion())) {\n      return false;\n    }\n    return !getLoggedInUser();\n  },\n  async run(serverless) {\n    const { inquirer } = serverless.interactiveCli;\n    if (!(await enableConfirm(inquirer, serverless.processedInput.options))) {\n      return null;\n    }\n    process.stdout.write('You are not logged in or you do not have a Serverless account.\\n\\n');\n    return steps.registerOrLogin(serverless);\n  },\n  steps,\n};\n"],"file":"register.js"}