{"version":3,"sources":["../../../../lib/safeguards/policies/required-stack-tags.js"],"names":["module","exports","requiredStackTagsPolicy","policy","service","requiredStackTags","failed","stackTags","declaration","provider","Object","keys","key","fail","match","approve","docs"],"mappings":"AAAA;;AAEAA,MAAM,CAACC,OAAP,GAAiB,SAASC,uBAAT,CAAiCC,MAAjC,EAAyCC,OAAzC,EAAkDC,iBAAlD,EAAqE;AACpF,MAAIC,MAAM,GAAG,KAAb;AACA,QAAMC,SAAS,GAAGH,OAAO,CAACI,WAAR,CAAoBC,QAApB,CAA6BF,SAA7B,IAA0C,EAA5D;;AACA,kCAAkBG,MAAM,CAACC,IAAP,CAAYN,iBAAZ,CAAlB,kCAAkD;AAA7C,UAAMO,GAAG,mBAAT;;AACH,QAAI,EAAEA,GAAG,IAAIL,SAAT,CAAJ,EAAyB;AACvBD,MAAAA,MAAM,GAAG,IAAT;AACAH,MAAAA,MAAM,CAACU,IAAP,CAAa,sBAAqBD,GAAI,UAAtC;AACD,KAHD,MAGO,IAAI,CAACL,SAAS,CAACK,GAAD,CAAT,CAAeE,KAAf,CAAqBT,iBAAiB,CAACO,GAAD,CAAtC,CAAL,EAAmD;AACxDN,MAAAA,MAAM,GAAG,IAAT;AACAH,MAAAA,MAAM,CAACU,IAAP,CACG,sBAAqBD,GAAI,UAASL,SAAS,CAACK,GAAD,CAAM,2BAA0BP,iBAAiB,CAACO,GAAD,CAAM,EADrG;AAGD;AACF;;AACD,MAAI,CAACN,MAAL,EAAa;AACXH,IAAAA,MAAM,CAACY,OAAP;AACD;AACF,CAjBD;;AAmBAf,MAAM,CAACC,OAAP,CAAee,IAAf,GAAsB,uCAAtB","sourcesContent":["'use strict';\n\nmodule.exports = function requiredStackTagsPolicy(policy, service, requiredStackTags) {\n  let failed = false;\n  const stackTags = service.declaration.provider.stackTags || {};\n  for (const key of Object.keys(requiredStackTags)) {\n    if (!(key in stackTags)) {\n      failed = true;\n      policy.fail(`Required stack tag ${key} not set`);\n    } else if (!stackTags[key].match(requiredStackTags[key])) {\n      failed = true;\n      policy.fail(\n        `Required stack tag ${key} value ${stackTags[key]} does not match RegExp: ${requiredStackTags[key]}`\n      );\n    }\n  }\n  if (!failed) {\n    policy.approve();\n  }\n};\n\nmodule.exports.docs = 'http://slss.io/sg-required-stack-tags';\n"],"file":"required-stack-tags.js"}