{"version":3,"sources":["../../lib/errorHandler.js"],"names":["serializeError","require","parseDeploymentData","module","exports","ctx","error","sls","cli","log","deployment","result","save","dashboardUrl","state","complete"],"mappings":"AAAA;AAEA;;;;;;;;AAIA,MAAMA,cAAc,GAAGC,OAAO,CAAC,kBAAD,CAA9B;;iBACgCA,OAAO,CAAC,cAAD,C;MAA/BC,mB,YAAAA,mB;;AAERC,MAAM,CAACC,OAAP,GAAiB,UAAUC,GAAV,EAAe;AAC9B;AAAA,iCAAO,WAAgBC,KAAhB,EAAuB;AAC5B;;;;AAKAD,MAAAA,GAAG,CAACE,GAAJ,CAAQC,GAAR,CAAYC,GAAZ,CAAgB,mDAAhB;AAEA,YAAMC,UAAU,SAASR,mBAAmB,CAACG,GAAD,EAAM,OAAN,EAAeL,cAAc,CAACM,KAAD,CAA7B,CAA5C;AAEA,YAAMK,MAAM,SAASD,UAAU,CAACE,IAAX,EAArB;AAEAP,MAAAA,GAAG,CAACE,GAAJ,CAAQC,GAAR,CAAYC,GAAZ,CACG,oEAAmEE,MAAM,CAACE,YAAa,EAD1F;;AAGA,UAAI,CAACR,GAAG,CAACS,KAAJ,CAAUJ,UAAf,EAA2B;AACzBL,QAAAA,GAAG,CAACS,KAAJ,CAAUJ,UAAV,GAAuB,EAAvB;AACD;;AACDL,MAAAA,GAAG,CAACS,KAAJ,CAAUJ,UAAV,CAAqBK,QAArB,GAAgC,IAAhC;AACD,KAnBD;;AAAA;AAAA;AAAA;AAAA;AAoBD,CArBD","sourcesContent":["'use strict';\n\n/*\n * Error Handler\n */\n\nconst serializeError = require('./serializeError');\nconst { parseDeploymentData } = require('./deployment');\n\nmodule.exports = function (ctx) {\n  return async function (error) {\n    /*\n     * Error: Failed Deployment\n     * - Handle failed deployments\n     */\n\n    ctx.sls.cli.log('Publishing service to the Serverless Dashboard...');\n\n    const deployment = await parseDeploymentData(ctx, 'error', serializeError(error));\n\n    const result = await deployment.save();\n\n    ctx.sls.cli.log(\n      `Successfully published your service to the Serverless Dashboard: ${result.dashboardUrl}`\n    );\n    if (!ctx.state.deployment) {\n      ctx.state.deployment = {};\n    }\n    ctx.state.deployment.complete = true;\n  };\n};\n"],"file":"errorHandler.js"}