{"version":3,"sources":["../../src/logout/index.js"],"names":["utils","logout","configFile","readConfigFile","userId","users","loggedInUser","dashboard","accessToken","idToken","expiresAt","enterprise","versionSDK","currentSdkVersion","timeLastLogout","Math","round","Date","updatedConfigFile","writeConfigFile","module","exports"],"mappings":";;AAMA;;AACA;;IAAYA,K;;;;2cAPZ;;;;;;AASA,IAAMC;AAAA,qEAAS;AAAA;AAAA;AAAA;AAAA;AAAA;AACb;AACMC,sBAFO,GAEMF,MAAMG,cAAN,EAFN;;AAAA,gBAGRD,UAHQ;AAAA;AAAA;AAAA;;AAAA;;AAAA;;AAOb,gBAAIA,WAAWE,MAAX,IAAqBF,WAAWG,KAApC,EAA2C;AACnCC,0BADmC,GACpBJ,WAAWG,KAAX,CAAiBH,WAAWE,MAA5B,CADoB;;AAGzC;;AACA,kBAAIE,aAAaC,SAAjB,EAA4B;AAC1BD,6BAAaC,SAAb,CAAuBC,WAAvB,GAAqC,IAArC;AACAF,6BAAaC,SAAb,CAAuBE,OAAvB,GAAiC,IAAjC;AACAH,6BAAaC,SAAb,CAAuBG,SAAvB,GAAmC,IAAnC;AACD;;AAED;AACAJ,2BAAaK,UAAb,GAA0BL,aAAaK,UAAb,IAA2B,EAArD;AACAL,2BAAaK,UAAb,CAAwBC,UAAxB,GAAqCC,gBAArC;AACAP,2BAAaK,UAAb,CAAwBG,cAAxB,GAAyCC,KAAKC,KAAL,CAAW,CAAC,IAAIC,IAAJ,EAAD,GAAc,IAAzB,CAAzC;;AAEAf,yBAAWE,MAAX,GAAoB,IAApB;AACD;;AAED;AACMc,6BA1BO,GA0BalB,MAAMmB,eAAN,CAAsBjB,UAAtB,CA1Bb;;AA4Bb;;AA5Ba,6CA8BNgB,iBA9BM;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAT;;AAAA;AAAA;AAAA;AAAA,GAAN;;AAiCAE,OAAOC,OAAP,GAAiB,EAAEpB,MAAF,EAAjB","file":"index.js","sourcesContent":["/*\n * Logout\n * - Logs user out.\n * - Loads and updates data in user's .serverlessrc.\n */\n\nimport { version as currentSdkVersion } from '../../package.json'\nimport * as utils from '../utils'\n\nconst logout = async () => {\n  // Load local configuration file\n  const configFile = utils.readConfigFile()\n  if (!configFile) {\n    return\n  }\n\n  if (configFile.userId && configFile.users) {\n    const loggedInUser = configFile.users[configFile.userId]\n\n    // Update dashboard data\n    if (loggedInUser.dashboard) {\n      loggedInUser.dashboard.accessToken = null\n      loggedInUser.dashboard.idToken = null\n      loggedInUser.dashboard.expiresAt = null\n    }\n\n    // Update enterprise data\n    loggedInUser.enterprise = loggedInUser.enterprise || {}\n    loggedInUser.enterprise.versionSDK = currentSdkVersion\n    loggedInUser.enterprise.timeLastLogout = Math.round(+new Date() / 1000)\n\n    configFile.userId = null\n  }\n\n  // Write updated data to .serverlessrc\n  const updatedConfigFile = utils.writeConfigFile(configFile)\n\n  // TODO: Log Stat\n\n  return updatedConfigFile\n}\n\nmodule.exports = { logout }\n"]}